{"metadata":{},"options":{"plugins":[{"key":"base$1$0","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"base$1$1","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"base$0$1","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$2","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"ClassPrivateProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"base$0$3","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$4","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-meteor-async-await","visitor":{"AwaitExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]}},"options":{"useNativeAsyncAwait":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"base$0$7","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"base$0$8","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"base$0$9","visitor":{"_exploded":{},"_verified":{},"PrivateName":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}}],"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/home/wangziguan/wzg/EnergyMaster/packages/wangziguan:admin/lib/server/publish.coffee","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","jsx",["flow",{}],["flow",{}],"objectRestSpread","objectRestSpread","dynamicImport","asyncGenerators","classProperties","classPrivateProperties"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"strictMode":false},"caller":{"name":"meteor","arch":"os.linux.x86_64"},"sourceFileName":"packages/wangziguan:admin/lib/server/publish.coffee","filename":"/home/wangziguan/wzg/EnergyMaster/packages/wangziguan:admin/lib/server/publish.coffee","passPerPreset":false,"envName":"development","cwd":"/home/wangziguan/wzg/EnergyMaster","root":"/home/wangziguan/wzg/EnergyMaster","presets":[],"generatorOpts":{"filename":"/home/wangziguan/wzg/EnergyMaster/packages/wangziguan:admin/lib/server/publish.coffee","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"packages/wangziguan:admin/lib/server/publish.coffee"}},"code":"Meteor.publishComposite('adminCollectionDoc', function (collection, id) {\n  var ref, ref1;\n  check(collection, String);\n  check(id, Match.OneOf(String, Mongo.ObjectID));\n\n  if (Roles.userIsInRole(this.userId, ['admin'])) {\n    return {\n      find: function () {\n        return adminCollectionObject(collection).find(id);\n      },\n      children: (typeof AdminConfig !== \"undefined\" && AdminConfig !== null ? (ref = AdminConfig.collections) != null ? (ref1 = ref[collection]) != null ? ref1.children : void 0 : void 0 : void 0) || []\n    };\n  } else {\n    return this.ready();\n  }\n});\nMeteor.publish('adminUsers', function () {\n  if (Roles.userIsInRole(this.userId, ['admin'])) {\n    return Meteor.users.find();\n  } else {\n    return this.ready();\n  }\n});\nMeteor.publish('adminUser', function () {\n  return Meteor.users.find(this.userId);\n});\nMeteor.publish('adminCollectionsCount', function () {\n  var handles, self;\n  handles = [];\n  self = this;\n\n  _.each(AdminTables, function (table, name) {\n    var count, id, ready, selector;\n    id = new Mongo.ObjectID();\n    count = 0;\n    table = AdminTables[name];\n    ready = false;\n    selector = table.selector ? table.selector(self.userId) : {};\n    handles.push(table.collection.find().observeChanges({\n      added: function () {\n        count += 1;\n        return ready && self.changed('adminCollectionsCount', id, {\n          count: count\n        });\n      },\n      removed: function () {\n        count -= 1;\n        return ready && self.changed('adminCollectionsCount', id, {\n          count: count\n        });\n      }\n    }));\n    ready = true;\n    return self.added('adminCollectionsCount', id, {\n      collection: name,\n      count: count\n    });\n  });\n\n  self.onStop(function () {\n    return _.each(handles, function (handle) {\n      return handle.stop();\n    });\n  });\n  return self.ready();\n});\nMeteor.publish(null, function () {\n  return Meteor.roles.find({});\n});","map":{"version":3,"sources":["packages/wangziguan:admin/lib/server/publish.coffee"],"names":["Meteor","publishComposite","collection","id","ref","ref1","check","String","Match","OneOf","Mongo","ObjectID","Roles","userIsInRole","userId","find","adminCollectionObject","children","AdminConfig","collections","ready","publish","users","handles","self","_","each","AdminTables","table","name","count","selector","push","observeChanges","added","changed","removed","onStop","handle","stop","roles"],"mappings":"AAAAA,MAAM,CAACC,gBAAP,CAAwB,oBAAxB,EAA8C,UAASC,UAAT,EAAqBC,EAArB,EAAyB;AACrE,MAAIC,GAAJ,EAASC,IAAT;AACAC,EAAAA,KAAK,CAACJ,UAAD,EAAaK,MAAb,CAAL;AACAD,EAAAA,KAAK,CAACH,EAAD,EAAKK,KAAK,CAACC,KAAN,CAAYF,MAAZ,EAAoBG,KAAK,CAACC,QAA1B,CAAL,CAAL;;AACA,MAAIC,KAAK,CAACC,YAAN,CAAmB,KAAKC,MAAxB,EAAgC,CAAC,OAAD,CAAhC,CAAJ,EAAgD;AAC9C,WAAO;AACLC,MAAAA,IAAI,EAAE,YAAW;AACf,eAAOC,qBAAqB,CAACd,UAAD,CAArB,CAAkCa,IAAlC,CAAuCZ,EAAvC,CAAP;AACD,OAHI;AAILc,MAAAA,QAAQ,EAAE,CAAC,OAAOC,WAAP,KAAuB,WAAvB,IAAsCA,WAAW,KAAK,IAAtD,GAA6D,CAACd,GAAG,GAAGc,WAAW,CAACC,WAAnB,KAAmC,IAAnC,GAA0C,CAACd,IAAI,GAAGD,GAAG,CAACF,UAAD,CAAX,KAA4B,IAA5B,GAAmCG,IAAI,CAACY,QAAxC,GAAmD,KAAK,CAAlG,GAAsG,KAAK,CAAxK,GAA4K,KAAK,CAAlL,KAAwL;AAJ7L,KAAP;AAMD,GAPD,MAOO;AACL,WAAO,KAAKG,KAAL,EAAP;AACD;AACF,CAdD;AAgBApB,MAAM,CAACqB,OAAP,CAAe,YAAf,EAA6B,YAAW;AACtC,MAAIT,KAAK,CAACC,YAAN,CAAmB,KAAKC,MAAxB,EAAgC,CAAC,OAAD,CAAhC,CAAJ,EAAgD;AAC9C,WAAOd,MAAM,CAACsB,KAAP,CAAaP,IAAb,EAAP;AACD,GAFD,MAEO;AACL,WAAO,KAAKK,KAAL,EAAP;AACD;AACF,CAND;AAQApB,MAAM,CAACqB,OAAP,CAAe,WAAf,EAA4B,YAAW;AACrC,SAAOrB,MAAM,CAACsB,KAAP,CAAaP,IAAb,CAAkB,KAAKD,MAAvB,CAAP;AACD,CAFD;AAIAd,MAAM,CAACqB,OAAP,CAAe,uBAAf,EAAwC,YAAW;AACjD,MAAIE,OAAJ,EAAaC,IAAb;AACAD,EAAAA,OAAO,GAAG,EAAV;AACAC,EAAAA,IAAI,GAAG,IAAP;;AACAC,EAAAA,CAAC,CAACC,IAAF,CAAOC,WAAP,EAAoB,UAASC,KAAT,EAAgBC,IAAhB,EAAsB;AACxC,QAAIC,KAAJ,EAAW3B,EAAX,EAAeiB,KAAf,EAAsBW,QAAtB;AACA5B,IAAAA,EAAE,GAAG,IAAIO,KAAK,CAACC,QAAV,EAAL;AACAmB,IAAAA,KAAK,GAAG,CAAR;AACAF,IAAAA,KAAK,GAAGD,WAAW,CAACE,IAAD,CAAnB;AACAT,IAAAA,KAAK,GAAG,KAAR;AACAW,IAAAA,QAAQ,GAAGH,KAAK,CAACG,QAAN,GAAiBH,KAAK,CAACG,QAAN,CAAeP,IAAI,CAACV,MAApB,CAAjB,GAA+C,EAA1D;AACAS,IAAAA,OAAO,CAACS,IAAR,CAAaJ,KAAK,CAAC1B,UAAN,CAAiBa,IAAjB,GAAwBkB,cAAxB,CAAuC;AAClDC,MAAAA,KAAK,EAAE,YAAW;AAChBJ,QAAAA,KAAK,IAAI,CAAT;AACA,eAAOV,KAAK,IAAII,IAAI,CAACW,OAAL,CAAa,uBAAb,EAAsChC,EAAtC,EAA0C;AACxD2B,UAAAA,KAAK,EAAEA;AADiD,SAA1C,CAAhB;AAGD,OANiD;AAOlDM,MAAAA,OAAO,EAAE,YAAW;AAClBN,QAAAA,KAAK,IAAI,CAAT;AACA,eAAOV,KAAK,IAAII,IAAI,CAACW,OAAL,CAAa,uBAAb,EAAsChC,EAAtC,EAA0C;AACxD2B,UAAAA,KAAK,EAAEA;AADiD,SAA1C,CAAhB;AAGD;AAZiD,KAAvC,CAAb;AAcAV,IAAAA,KAAK,GAAG,IAAR;AACA,WAAOI,IAAI,CAACU,KAAL,CAAW,uBAAX,EAAoC/B,EAApC,EAAwC;AAC7CD,MAAAA,UAAU,EAAE2B,IADiC;AAE7CC,MAAAA,KAAK,EAAEA;AAFsC,KAAxC,CAAP;AAID,GA1BD;;AA2BAN,EAAAA,IAAI,CAACa,MAAL,CAAY,YAAW;AACrB,WAAOZ,CAAC,CAACC,IAAF,CAAOH,OAAP,EAAgB,UAASe,MAAT,EAAiB;AACtC,aAAOA,MAAM,CAACC,IAAP,EAAP;AACD,KAFM,CAAP;AAGD,GAJD;AAKA,SAAOf,IAAI,CAACJ,KAAL,EAAP;AACD,CArCD;AAuCApB,MAAM,CAACqB,OAAP,CAAe,IAAf,EAAqB,YAAW;AAC9B,SAAOrB,MAAM,CAACwC,KAAP,CAAazB,IAAb,CAAkB,EAAlB,CAAP;AACD,CAFD","sourcesContent":["Meteor.publishComposite('adminCollectionDoc', function(collection, id) {\n  var ref, ref1;\n  check(collection, String);\n  check(id, Match.OneOf(String, Mongo.ObjectID));\n  if (Roles.userIsInRole(this.userId, ['admin'])) {\n    return {\n      find: function() {\n        return adminCollectionObject(collection).find(id);\n      },\n      children: (typeof AdminConfig !== \"undefined\" && AdminConfig !== null ? (ref = AdminConfig.collections) != null ? (ref1 = ref[collection]) != null ? ref1.children : void 0 : void 0 : void 0) || []\n    };\n  } else {\n    return this.ready();\n  }\n});\n\nMeteor.publish('adminUsers', function() {\n  if (Roles.userIsInRole(this.userId, ['admin'])) {\n    return Meteor.users.find();\n  } else {\n    return this.ready();\n  }\n});\n\nMeteor.publish('adminUser', function() {\n  return Meteor.users.find(this.userId);\n});\n\nMeteor.publish('adminCollectionsCount', function() {\n  var handles, self;\n  handles = [];\n  self = this;\n  _.each(AdminTables, function(table, name) {\n    var count, id, ready, selector;\n    id = new Mongo.ObjectID;\n    count = 0;\n    table = AdminTables[name];\n    ready = false;\n    selector = table.selector ? table.selector(self.userId) : {};\n    handles.push(table.collection.find().observeChanges({\n      added: function() {\n        count += 1;\n        return ready && self.changed('adminCollectionsCount', id, {\n          count: count\n        });\n      },\n      removed: function() {\n        count -= 1;\n        return ready && self.changed('adminCollectionsCount', id, {\n          count: count\n        });\n      }\n    }));\n    ready = true;\n    return self.added('adminCollectionsCount', id, {\n      collection: name,\n      count: count\n    });\n  });\n  self.onStop(function() {\n    return _.each(handles, function(handle) {\n      return handle.stop();\n    });\n  });\n  return self.ready();\n});\n\nMeteor.publish(null, function() {\n  return Meteor.roles.find({});\n});\n"]},"sourceType":"script","hash":"78df3e6ff9fdbc54bb69df90d5f42b9bc879d651"}
