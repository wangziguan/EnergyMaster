{"source":"__coffeescriptShare = typeof __coffeescriptShare === 'object' ? __coffeescriptShare : {}; var share = __coffeescriptShare;\nvar adminCollections;\nTemplate.registerHelper('AdminTables', AdminTables);\n\nadminCollections = function () {\n  var collections;\n  collections = {};\n\n  if (typeof AdminConfig !== 'undefined' && typeof AdminConfig.collections === 'object') {\n    collections = AdminConfig.collections;\n  }\n\n  collections.Users = {\n    collectionObject: Meteor.users,\n    icon: 'user',\n    label: '账号管理'\n  };\n  return _.map(collections, function (obj, key) {\n    obj = _.extend(obj, {\n      name: key\n    });\n    obj = _.defaults(obj, {\n      label: key,\n      icon: 'plus',\n      color: 'blue'\n    });\n    return obj = _.extend(obj, {\n      viewPath: Router.path(\"adminDashboard\".concat(key, \"View\")),\n      newPath: Router.path(\"adminDashboard\".concat(key, \"New\"))\n    });\n  });\n};\n\nUI.registerHelper('AdminConfig', function () {\n  if (typeof AdminConfig !== 'undefined') {\n    return AdminConfig;\n  }\n});\nUI.registerHelper('admin_skin', function () {\n  return (typeof AdminConfig !== \"undefined\" && AdminConfig !== null ? AdminConfig.skin : void 0) || 'blue';\n});\nUI.registerHelper('admin_collections', adminCollections);\nUI.registerHelper('admin_collection_name', function () {\n  return Session.get('admin_collection_name');\n});\nUI.registerHelper('admin_current_id', function () {\n  return Session.get('admin_id');\n});\nUI.registerHelper('admin_current_doc', function () {\n  return Session.get('admin_doc');\n});\nUI.registerHelper('admin_is_users_collection', function () {\n  return Session.get('admin_collection_name') === 'Users';\n});\nUI.registerHelper('admin_sidebar_items', function () {\n  return AdminDashboard.sidebarItems;\n});\nUI.registerHelper('admin_collection_items', function () {\n  var items;\n  items = [];\n\n  _.each(AdminDashboard.collectionItems, fn => {\n    var item;\n    item = fn(this.name, '/admin/' + this.name);\n\n    if ((item != null ? item.title : void 0) && (item != null ? item.url : void 0)) {\n      return items.push(item);\n    }\n  });\n\n  return items;\n});\nUI.registerHelper('admin_omit_fields', function () {\n  var collection, global;\n\n  if (typeof AdminConfig.autoForm !== 'undefined' && typeof AdminConfig.autoForm.omitFields === 'object') {\n    global = AdminConfig.autoForm.omitFields;\n  }\n\n  if (!Session.equals('admin_collection_name', 'Users') && typeof AdminConfig !== 'undefined' && typeof AdminConfig.collections[Session.get('admin_collection_name')].omitFields === 'object') {\n    collection = AdminConfig.collections[Session.get('admin_collection_name')].omitFields;\n  }\n\n  if (typeof global === 'object' && typeof collection === 'object') {\n    return _.union(global, collection);\n  } else if (typeof global === 'object') {\n    return global;\n  } else if (typeof collection === 'object') {\n    return collection;\n  }\n});\nUI.registerHelper('AdminSchemas', function () {\n  return AdminDashboard.schemas;\n});\nUI.registerHelper('adminGetSkin', function () {\n  if (typeof AdminConfig.dashboard !== 'undefined' && typeof AdminConfig.dashboard.skin === 'string') {\n    return AdminConfig.dashboard.skin;\n  } else {\n    return 'blue';\n  }\n});\nUI.registerHelper('adminIsUserInRole', function (_id, role) {\n  return Roles.userIsInRole(_id, role);\n});\nUI.registerHelper('adminGetUsers', function () {\n  return Meteor.users;\n});\nUI.registerHelper('adminGetUserSchema', function () {\n  var schema;\n\n  if (_.has(AdminConfig, 'userSchema')) {\n    schema = AdminConfig.userSchema;\n  } else if (typeof Meteor.users._c2 === 'object') {\n    schema = Meteor.users.simpleSchema();\n  }\n\n  return schema;\n});\nUI.registerHelper('adminCollectionLabel', function (collection) {\n  if (collection != null) {\n    return AdminDashboard.collectionLabel(collection);\n  }\n});\nUI.registerHelper('adminCollectionCount', function (collection) {\n  var ref;\n\n  if (collection === 'Users') {\n    return Meteor.users.find().count();\n  } else {\n    return (ref = AdminCollectionsCount.findOne({\n      collection: collection\n    })) != null ? ref.count : void 0;\n  }\n});\nUI.registerHelper('adminTemplate', function (collection, mode) {\n  var ref, ref1;\n\n  if ((collection != null ? collection.toLowerCase() : void 0) !== 'users' && typeof (typeof AdminConfig !== \"undefined\" && AdminConfig !== null ? (ref = AdminConfig.collections) != null ? (ref1 = ref[collection]) != null ? ref1.templates : void 0 : void 0 : void 0) !== 'undefined') {\n    return AdminConfig.collections[collection].templates[mode];\n  }\n});\nUI.registerHelper('adminGetCollection', function (collection) {\n  return _.find(adminCollections(), function (item) {\n    return item.name === collection;\n  });\n});\nUI.registerHelper('adminWidgets', function () {\n  if (typeof AdminConfig.dashboard !== 'undefined' && typeof AdminConfig.dashboard.widgets !== 'undefined') {\n    return AdminConfig.dashboard.widgets;\n  }\n});\nUI.registerHelper('adminUserEmail', function (user) {\n  if (user && user.emails && user.emails[0] && user.emails[0].address) {\n    return user.emails[0].address;\n  } else if (user && user.services && user.services.facebook && user.services.facebook.email) {\n    return user.services.facebook.email;\n  } else if (user && user.services && user.services.google && user.services.google.email) {\n    return user.services.google.email;\n  }\n});","sourceMap":{"version":3,"sources":["/packages/wangziguan_admin/lib/client/js/helpers.coffee","/lib/client/js/helpers.coffee"],"names":["adminCollections","Template","registerHelper","AdminTables","collections","AdminConfig","Users","collectionObject","Meteor","users","icon","label","_","map","obj","key","extend","name","defaults","color","viewPath","Router","path","newPath","UI","skin","Session","get","AdminDashboard","sidebarItems","items","each","collectionItems","fn","item","title","url","push","collection","global","autoForm","omitFields","equals","union","schemas","dashboard","_id","role","Roles","userIsInRole","schema","has","userSchema","_c2","simpleSchema","collectionLabel","ref","find","count","AdminCollectionsCount","findOne","mode","ref1","toLowerCase","templates","widgets","user","emails","address","services","facebook","email","google"],"mappings":"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","file":"packages/wangziguan:admin/lib/client/js/helpers.coffee.map","sourcesContent":["Template.registerHelper('AdminTables', AdminTables);\n\nadminCollections = ->\n\tcollections = {}\n\n\tif typeof AdminConfig != 'undefined'  and typeof AdminConfig.collections == 'object'\n\t\tcollections = AdminConfig.collections\n\n\tcollections.Users =\n\t\tcollectionObject: Meteor.users\n\t\ticon: 'user'\n\t\tlabel: '账号管理'\n\n\t_.map collections, (obj, key) ->\n\t\tobj = _.extend obj, {name: key}\n\t\tobj = _.defaults obj, {label: key, icon: 'plus', color: 'blue'}\n\t\tobj = _.extend obj,\n\t\t\tviewPath: Router.path \"adminDashboard#{key}View\"\n\t\t\tnewPath: Router.path \"adminDashboard#{key}New\"\n\nUI.registerHelper 'AdminConfig', ->\n\tAdminConfig if typeof AdminConfig != 'undefined'\n\nUI.registerHelper 'admin_skin', ->\n\tAdminConfig?.skin or 'blue'\n\nUI.registerHelper 'admin_collections', adminCollections\n\nUI.registerHelper 'admin_collection_name', ->\n\tSession.get 'admin_collection_name'\n\nUI.registerHelper 'admin_current_id', ->\n\tSession.get 'admin_id'\n\nUI.registerHelper 'admin_current_doc', ->\n\tSession.get 'admin_doc'\n\nUI.registerHelper 'admin_is_users_collection', ->\n\tSession.get('admin_collection_name') == 'Users'\n\nUI.registerHelper 'admin_sidebar_items', ->\n\tAdminDashboard.sidebarItems\n\nUI.registerHelper 'admin_collection_items', ->\n\titems = []\n\t_.each AdminDashboard.collectionItems, (fn) =>\n\t\titem = fn @name, '/admin/' + @name\n\t\tif item?.title and item?.url\n\t\t\titems.push item\n\titems\n\nUI.registerHelper 'admin_omit_fields', ->\n\tif typeof AdminConfig.autoForm != 'undefined' and typeof AdminConfig.autoForm.omitFields == 'object'\n\t\tglobal = AdminConfig.autoForm.omitFields\n\tif not Session.equals('admin_collection_name','Users') and typeof AdminConfig != 'undefined' and typeof AdminConfig.collections[Session.get 'admin_collection_name'].omitFields == 'object'\n\t\tcollection = AdminConfig.collections[Session.get 'admin_collection_name'].omitFields\n\tif typeof global == 'object' and typeof collection == 'object'\n\t\t_.union global, collection\n\telse if typeof global == 'object'\n\t\tglobal\n\telse if typeof collection == 'object'\n\t\tcollection\n\nUI.registerHelper 'AdminSchemas', ->\n\tAdminDashboard.schemas\n\nUI.registerHelper 'adminGetSkin', ->\n\tif typeof AdminConfig.dashboard != 'undefined' and typeof AdminConfig.dashboard.skin == 'string'\n\t\tAdminConfig.dashboard.skin\n\telse\n\t\t'blue'\n\nUI.registerHelper 'adminIsUserInRole', (_id,role)->\n\tRoles.userIsInRole _id, role\n\nUI.registerHelper 'adminGetUsers', ->\n\tMeteor.users\n\nUI.registerHelper 'adminGetUserSchema', ->\n\tif _.has(AdminConfig, 'userSchema')\n\t\tschema = AdminConfig.userSchema\n\telse if typeof Meteor.users._c2 == 'object'\n\t\tschema = Meteor.users.simpleSchema()\n\n\treturn schema\n\nUI.registerHelper 'adminCollectionLabel', (collection)->\n\tAdminDashboard.collectionLabel(collection) if collection?\n\nUI.registerHelper 'adminCollectionCount', (collection)->\n\tif collection == 'Users'\n\t\tMeteor.users.find().count()\n\telse\n\t\tAdminCollectionsCount.findOne({collection: collection})?.count\n\nUI.registerHelper 'adminTemplate', (collection, mode)->\n\tif collection?.toLowerCase() != 'users' && typeof AdminConfig?.collections?[collection]?.templates != 'undefined'\n\t\tAdminConfig.collections[collection].templates[mode]\n\nUI.registerHelper 'adminGetCollection', (collection)->\n\t_.find adminCollections(), (item) -> item.name == collection\n\nUI.registerHelper 'adminWidgets', ->\n\tif typeof AdminConfig.dashboard != 'undefined' and typeof AdminConfig.dashboard.widgets != 'undefined'\n\t\tAdminConfig.dashboard.widgets\n\nUI.registerHelper 'adminUserEmail', (user) ->\n\tif user && user.emails && user.emails[0] && user.emails[0].address\n\t\tuser.emails[0].address\n\telse if user && user.services && user.services.facebook && user.services.facebook.email\n\t\tuser.services.facebook.email\n\telse if user && user.services && user.services.google && user.services.google.email\n\t\tuser.services.google.email\n","var adminCollections;\n\nTemplate.registerHelper('AdminTables', AdminTables);\n\nadminCollections = function() {\n  var collections;\n  collections = {};\n  if (typeof AdminConfig !== 'undefined' && typeof AdminConfig.collections === 'object') {\n    collections = AdminConfig.collections;\n  }\n  collections.Users = {\n    collectionObject: Meteor.users,\n    icon: 'user',\n    label: '账号管理'\n  };\n  return _.map(collections, function(obj, key) {\n    obj = _.extend(obj, {\n      name: key\n    });\n    obj = _.defaults(obj, {\n      label: key,\n      icon: 'plus',\n      color: 'blue'\n    });\n    return obj = _.extend(obj, {\n      viewPath: Router.path(`adminDashboard${key}View`),\n      newPath: Router.path(`adminDashboard${key}New`)\n    });\n  });\n};\n\nUI.registerHelper('AdminConfig', function() {\n  if (typeof AdminConfig !== 'undefined') {\n    return AdminConfig;\n  }\n});\n\nUI.registerHelper('admin_skin', function() {\n  return (typeof AdminConfig !== \"undefined\" && AdminConfig !== null ? AdminConfig.skin : void 0) || 'blue';\n});\n\nUI.registerHelper('admin_collections', adminCollections);\n\nUI.registerHelper('admin_collection_name', function() {\n  return Session.get('admin_collection_name');\n});\n\nUI.registerHelper('admin_current_id', function() {\n  return Session.get('admin_id');\n});\n\nUI.registerHelper('admin_current_doc', function() {\n  return Session.get('admin_doc');\n});\n\nUI.registerHelper('admin_is_users_collection', function() {\n  return Session.get('admin_collection_name') === 'Users';\n});\n\nUI.registerHelper('admin_sidebar_items', function() {\n  return AdminDashboard.sidebarItems;\n});\n\nUI.registerHelper('admin_collection_items', function() {\n  var items;\n  items = [];\n  _.each(AdminDashboard.collectionItems, (fn) => {\n    var item;\n    item = fn(this.name, '/admin/' + this.name);\n    if ((item != null ? item.title : void 0) && (item != null ? item.url : void 0)) {\n      return items.push(item);\n    }\n  });\n  return items;\n});\n\nUI.registerHelper('admin_omit_fields', function() {\n  var collection, global;\n  if (typeof AdminConfig.autoForm !== 'undefined' && typeof AdminConfig.autoForm.omitFields === 'object') {\n    global = AdminConfig.autoForm.omitFields;\n  }\n  if (!Session.equals('admin_collection_name', 'Users') && typeof AdminConfig !== 'undefined' && typeof AdminConfig.collections[Session.get('admin_collection_name')].omitFields === 'object') {\n    collection = AdminConfig.collections[Session.get('admin_collection_name')].omitFields;\n  }\n  if (typeof global === 'object' && typeof collection === 'object') {\n    return _.union(global, collection);\n  } else if (typeof global === 'object') {\n    return global;\n  } else if (typeof collection === 'object') {\n    return collection;\n  }\n});\n\nUI.registerHelper('AdminSchemas', function() {\n  return AdminDashboard.schemas;\n});\n\nUI.registerHelper('adminGetSkin', function() {\n  if (typeof AdminConfig.dashboard !== 'undefined' && typeof AdminConfig.dashboard.skin === 'string') {\n    return AdminConfig.dashboard.skin;\n  } else {\n    return 'blue';\n  }\n});\n\nUI.registerHelper('adminIsUserInRole', function(_id, role) {\n  return Roles.userIsInRole(_id, role);\n});\n\nUI.registerHelper('adminGetUsers', function() {\n  return Meteor.users;\n});\n\nUI.registerHelper('adminGetUserSchema', function() {\n  var schema;\n  if (_.has(AdminConfig, 'userSchema')) {\n    schema = AdminConfig.userSchema;\n  } else if (typeof Meteor.users._c2 === 'object') {\n    schema = Meteor.users.simpleSchema();\n  }\n  return schema;\n});\n\nUI.registerHelper('adminCollectionLabel', function(collection) {\n  if (collection != null) {\n    return AdminDashboard.collectionLabel(collection);\n  }\n});\n\nUI.registerHelper('adminCollectionCount', function(collection) {\n  var ref;\n  if (collection === 'Users') {\n    return Meteor.users.find().count();\n  } else {\n    return (ref = AdminCollectionsCount.findOne({\n      collection: collection\n    })) != null ? ref.count : void 0;\n  }\n});\n\nUI.registerHelper('adminTemplate', function(collection, mode) {\n  var ref, ref1;\n  if ((collection != null ? collection.toLowerCase() : void 0) !== 'users' && typeof (typeof AdminConfig !== \"undefined\" && AdminConfig !== null ? (ref = AdminConfig.collections) != null ? (ref1 = ref[collection]) != null ? ref1.templates : void 0 : void 0 : void 0) !== 'undefined') {\n    return AdminConfig.collections[collection].templates[mode];\n  }\n});\n\nUI.registerHelper('adminGetCollection', function(collection) {\n  return _.find(adminCollections(), function(item) {\n    return item.name === collection;\n  });\n});\n\nUI.registerHelper('adminWidgets', function() {\n  if (typeof AdminConfig.dashboard !== 'undefined' && typeof AdminConfig.dashboard.widgets !== 'undefined') {\n    return AdminConfig.dashboard.widgets;\n  }\n});\n\nUI.registerHelper('adminUserEmail', function(user) {\n  if (user && user.emails && user.emails[0] && user.emails[0].address) {\n    return user.emails[0].address;\n  } else if (user && user.services && user.services.facebook && user.services.facebook.email) {\n    return user.services.facebook.email;\n  } else if (user && user.services && user.services.google && user.services.google.email) {\n    return user.services.google.email;\n  }\n});\n"]}}